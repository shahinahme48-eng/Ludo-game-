<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ludo Royal Cash</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 pb-24">
    <script>
        // --- ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï‡¶ü‡¶ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶¶‡¶ø‡¶® ---
        const R_URL = "https://ludo-pro-engine.onrender.com"; 
        
        if(!localStorage.getItem('LUDO_ID')) localStorage.setItem('LUDO_ID', "SN"+Math.floor(1000+Math.random()*9000));
        const userId = localStorage.getItem('LUDO_ID');
        const socket = io(R_URL);

        async function loadData() {
            try {
                // ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶≤‡ßã‡¶°
                const resB = await fetch(`${R_URL}/api/balance?userId=${userId}`);
                const dataB = await resB.json();
                document.getElementById('balance').innerText = dataB.balance || 0;
                
                // ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ (‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞) ‡¶≤‡ßã‡¶°
                const resS = await fetch(`${R_URL}/api/settings`);
                const dataS = await resS.json();
                document.getElementById('d-bk').innerText = dataS.bikash;
                document.getElementById('wa-link').href = `https://wa.me/${dataS.wa}?text=ID:${userId}`;
                
                document.getElementById('my-code').innerText = userId;
            } catch(e) { 
                console.log("Waiting for server..."); 
            }
        }

        socket.on("connect", () => { document.getElementById('status').innerText = "ONLINE üü¢"; });
        socket.on("diceRolled", (data) => {
             document.getElementById('dice-val').innerText = data.value;
        });

        function roll() {
            const v = Math.floor(Math.random() * 6) + 1;
            socket.emit("rollDice", { roomId: "global", value: v });
        }

        async function dep() {
            const amount = document.getElementById('amt').value;
            const trxId = document.getElementById('trx').value;
            await fetch(`${R_URL}/api/deposit`, { 
                method: 'POST', 
                headers: {'Content-Type': 'application/json'}, 
                body: JSON.stringify({ userId, amount, trxId, type: 'deposit' }) 
            });
            alert("Sent!");
        }

        function showTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.style.display = 'none');
            document.getElementById(id).style.display = 'block';
        }

        setInterval(loadData, 3000); // ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ß© ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞ ‡¶™‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶¨‡ßá
        window.onload = loadData;
    </script>

    <!-- UI ‡¶Ö‡¶Ç‡¶∂ (‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§) -->
    <div class="bg-blue-600 text-white p-4 flex justify-between shadow-lg sticky top-0 z-50">
        <h1 class="font-bold">LUDO ROYAL</h1>
        <p class="font-bold text-yellow-300">‡ß≥ <span id="balance">0</span></p>
    </div>

    <div id="game-tab" class="tab-content p-4 text-center">
        <div id="status" class="text-[10px] font-bold text-blue-600 mb-2">CONNECTING...</div>
        <button onclick="roll()" class="w-20 h-20 bg-white rounded-2xl shadow-xl text-3xl">üé≤ <span id="dice-val">?</span></button>
    </div>

    <div id="wallet-tab" class="tab-content hidden p-4 space-y-4">
        <div class="bg-gradient-to-r from-orange-400 to-yellow-500 p-5 rounded-3xl text-white">
            <p class="text-xs">My Refer Code: <span id="my-code" class="font-bold">...</span></p>
        </div>
        <div class="bg-white p-6 rounded-3xl shadow border-t-8 border-pink-500 text-center">
            <p id="d-bk" class="font-black text-xl text-pink-700 mb-4 italic">Loading...</p>
            <input type="number" id="amt" placeholder="Amount" class="w-full border p-3 rounded-xl mb-2">
            <input type="text" id="trx" placeholder="TrxID" class="w-full border p-3 rounded-xl mb-4">
            <button onclick="dep()" class="w-full bg-pink-600 text-white py-3 rounded-xl font-bold">SUBMIT</button>
        </div>
        <a id="wa-link" href="#" class="block bg-green-500 text-white p-4 rounded-2xl text-center font-bold">WhatsApp Help</a>
    </div>

    <div class="fixed bottom-0 w-full bg-white border-t flex justify-around p-4 shadow-xl">
        <button onclick="showTab('game-tab')">PLAY</button>
        <button onclick="showTab('wallet-tab')">WALLET</button>
    </div>
</body>
</html>
