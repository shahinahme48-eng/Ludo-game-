<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Admin - Approvals</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>body{background:#0f172a;color:white;font-family:sans-serif;}.card{background:#1e293b;border-radius:24px;padding:20px;border:1px solid #334155;margin-bottom:20px;}</style>
</head>
<body class="p-4" onload="checkPin()">
    <div id="main" class="hidden max-w-lg m-auto">
        <h1 class="text-blue-500 font-black text-xl italic mb-6 uppercase text-center">Admin Control</h1>
        
        <div class="card border-l-8 border-pink-500 shadow-xl">
            <h3 class="text-xs font-bold text-pink-500 mb-4 uppercase">Pending Requests (ডিপোজিট ও উইথড্র)</h3>
            <div id="req-list" class="space-y-4"></div>
        </div>

        <!-- বাকি সেটিংস সেকশন আগের মতো থাকবে -->
    </div>

    <script>
        const R_URL = "https://ludo-pro-engine.onrender.com";
        function checkPin(){ if(prompt("PIN:")==="2025") { document.getElementById('main').classList.remove('hidden'); load(); } else alert("Access Denied"); }

        async function load(){
            const res = await fetch(`${R_URL}/api/admin/requests`);
            const data = await res.json();
            document.getElementById('req-list').innerHTML = data.length === 0 ? 
                "<p class='text-center text-gray-500 py-10'>সব ক্লিয়ার!</p>" :
                data.map(r => `
                <div class="bg-slate-900 p-5 rounded-2xl border ${r.type === 'deposit' ? 'border-green-900' : 'border-blue-900'} shadow-inner">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <p class="text-[10px] font-bold uppercase ${r.type === 'deposit' ? 'text-green-500' : 'text-blue-500'}">${r.type}</p>
                            <p class="font-black text-2xl">৳${r.amount}</p>
                            <p class="text-[10px] text-gray-400 font-mono mt-1">${r.userId}</p>
                        </div>
                        <p class="text-[10px] bg-slate-800 p-2 rounded-lg font-mono text-yellow-500">${r.trxId || r.phone}</p>
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="handle('${r._id}', 'approve')" class="bg-green-600 text-white py-3 rounded-xl font-bold text-xs uppercase shadow-lg">Approve</button>
                        <button onclick="handle('${r._id}', 'reject')" class="bg-red-600 text-white py-3 rounded-xl font-bold text-xs uppercase shadow-lg">Reject</button>
                    </div>
                </div>
            `).join('');
        }

        async function handle(id, action){
            await fetch(`${R_URL}/api/admin/handleRequest`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ id, action })
            });
            alert("সফলভাবে সম্পন্ন হয়েছে!");
            load();
        }
    </script>
</body>
</html>
